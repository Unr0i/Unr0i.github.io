---
layout:     post
title:      Windows hook技术研究1
subtitle:   微信外发消息审计管控方案研究
date:       2023-08-21
author:     LanKai
header-img: img/post-bg-debug.png
catalog: true
tags:
    - Windows
    - Hook
    - 逆向
---


## 主题
- 某些场所保密性要求高，即时通讯软件提供便利的同时，数据外发就成了泄密的一个源头，如何高效稳定地监管外发消息值得研究一下
- 外发审计所使用到的基本都是hook技术，但是hook的选择也决定了稳定性和用户的影响程度，可能卡顿、崩溃，无法获取全部的数据
- 本文主要研究微信外发消息的审计和管控

### 正文

#### 1、信息汇总
- PC端微信外发需要审计的消息类型：
  - 1、文本
  - 2、图片、截图
  - 3、文件
  - 4、留言(依赖于发送文件操作)
  - 5、小图标icon
- 外发文件的方式
  - 1、点击微信聊天界面图标点选文件
  - 2、鼠标拖拽文件到聊天界面
- 发送方式
  - 1、点击界面的发送按键
  - 2、Enter或shift+Enter



